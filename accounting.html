<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <title>会計</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <script type="text/javascript" src="/socket.io/socket.io.js"></script>
</head>

<body>


  <input type="button" value="終了" id="end">
  <form>
    <select class="list" name="allList" id="allList" size="20"></select>
  </form>

  <script>
    window.onload = function () {
      var socket = io.connect();
      const endButton = document.getElementById('end');
      const allList = document.getElementById('allList');

      socket.on('server_to_client', function (data) {

        switch (data.meth) {
          case 'end':
            alert('待っている人はいません');
            break;
          default:
            write(data.value);
            break;
        }

      })
      function write(data) {
        removeAllChildren(allList);
        for (let i = 0; i < data.length; i++) {
          let a = document.createElement('option');
          let b = document.createTextNode(i + data[i]);
          a.appendChild(b);
          allList.appendChild(a);
        }
      }

      endButton.onclick = function () {
        socket.emit('client_to_server_personal', { value: 'null', meth: 'end' });
      }
    }
    function removeAllChildren(element) {
      while (element.firstChild) {
        element.removeChild(element.firstChild);
      }
    }

  </script>

  <style>
    select {
      width: 200px;
    }
  </style>

</body>

</html>