<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <title>部屋</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <script type="text/javascript" src="/socket.io/socket.io.js"></script>
</head>

<body>


  <input type="button" value="入室" id="enter">
  <input type="button" value="退室" id="leave">
  <form>
    <select class="list" name="allList" id="allList" size="20"></select>
  </form>

  <script>
    window.onload = function () {
      var socket = io.connect();
      const enterButton = document.getElementById('enter')
      const leaveButton = document.getElementById('leave');
      const allList = document.getElementById('allList');

      socket.on('server_to_client', function (data) {
        console.log('room30'+data.meth);

        switch (data.meth) {
          case 'enter':
            alert('待っている人はいません');
            break;
          case 'leave':
            alert('この部屋にはいません');
            break;

          default:
            write(data.value);
            break;
        }
        console.log('rece33' + data.value);

      })
      function write(data) {
        removeAllChildren(allList);
        for (let i = 0; i < data.length; i++) {
          let a = document.createElement('option');
          let b = document.createTextNode(data[i]);
          a.appendChild(b);
          allList.appendChild(a);
        }
      }

      enterButton.onclick = function () {
        socket.emit('client_to_server_personal', { value: 'null', meth: 'enter' })

      }
      leaveButton.onclick = function () {
        socket.emit('client_to_server_personal', { value: 'null', meth: 'leave' })

      }

    }
    function removeAllChildren(element) {
      while (element.firstChild) {
        element.removeChild(element.firstChild);
      }
    }

  </script>

  <style>
    select {
      width: 200px;
    }
  </style>

</body>

</html>